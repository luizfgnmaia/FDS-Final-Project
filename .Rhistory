as.Date(dados$Data, format = "%Y.%mm.%dd")
as.Date(dados$Data, format = "%Y.%m.%d")
dados = read.csv("data/ranktodos.csv", stringsAsFactors = FALSE) %>%
select(-X) %>%
rename(Clube = nome,
Pais = pais,
Elo = rate,
Data = date) %>%
mutate(Data = as.Date(Data, format = "%Y.%m.%d"))
library(dplyr)
source("aux_shiny.R")
dados = read.csv("data/ranktodos.csv", stringsAsFactors = FALSE) %>%
select(-X) %>%
rename(Clube = nome,
Pais = pais,
Elo = rate,
Data = date) %>%
mutate(Data = as.Date(Data, format = "%Y.%m.%d"))
dados$Clube[which(dados$id == 618)] = "River Plate (Par)"
dados$Clube[which(dados$id == 826)] = "River Plate (Uru)"
dados$Clube[which(dados$id == 414)] = "Fortaleza (Col)"
dados$Clube[which(dados$id == 611)] = "Guarani (Par)"
dados$Clube[which(dados$id == 113)] = "Independiente (Bol)"
dados$Clube[which(dados$id == 928)] = "Portuguesa (Ven)"
dados$Clube[which(dados$id == 620)] = "San Lorenzo (Par)"
dados$Clube[which(dados$id == 124)] = "Santa Cruz (Bol)"
dados$Clube[which(dados$id == 732)] = "Sport Boys (Per)"
dados$Clube[which(dados$id == 525)] = "U. Catolica (Equ)"
dados$Clube[which(dados$Pais == "Bolivia")] = "Bolívia"
dados$Clube[which(dados$Pais == "Colombia")] = "Colômbia"
flags_df = tibble(Pais = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador",
"Paraguai", "Peru", "Uruguai", "Venezuela"),
flag = c('<img src="https://flagpedia.net/data/flags/mini/ar.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/bo.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/br.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/cl.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/co.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/ec.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/py.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/pe.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/uy.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/ve.png" width="29" height="20" /></a>'))
clubes = dados %>%
filter(Data == max(dados$Data)) %>%
arrange(desc(Elo)) %>%
.$Clube
paises = sort(unique(dados$Pais))
datas = sort(unique(dados$Data))
len_datas = length(datas)
melhores_clubes = dados %>%
mutate(Ano = format(Data, "%Y")) %>%
group_by(Clube, Pais, Ano) %>%
summarise(Elo = max(Elo)) %>%
ungroup() %>%
arrange(desc(Elo)) %>%
head(50) %>%
inner_join(flags_df) %>%
mutate(Clube = paste(flag, Clube)) %>%
select(-Pais, -flag)
View(melhores_clubes)
maior_por_mes = dados %>%
group_by(Data) %>%
slice(which.max(Elo)) %>%
ungroup() %>%
mutate(Data = as.character(Data))
View(maior_por_mes)
clube = maior_por_mes$Clube[1]
pais = maior_por_mes$Pais[1]
de = maior_por_mes$Data[1]
ate = NULL
meses = NULL
j = 1
m = 1
for(i in 2:nrow(maior_por_mes)) {
if(!(clube[j] == maior_por_mes$Clube[i] & pais[j] == maior_por_mes$Pais[i])) {
meses[j] = m
ate[j] = maior_por_mes$Data[i-1]
j = j + 1
m = 1
clube[j] = maior_por_mes$Clube[i]
pais[j] = maior_por_mes$Pais[i]
de[j] = maior_por_mes$Data[i]
} else {
m = m + 1
}
}
ate = c(ate, NA)
meses = c(meses, m)
maiores_streaks = tibble(Clube = clube, Pais = pais, De = de, Ate = ate, Meses = meses) %>%
mutate(De = format(as.Date(De), "%b %Y"),
Ate = format(as.Date(Ate), "%b %Y")) %>%
arrange(desc(Meses)) %>%
inner_join(flags_df) %>%
mutate(Clube = paste(flag, Clube),
Meses = as.integer(Meses)) %>%
select(-Pais, -flag)
View(maiores_streaks)
rm(list = setdiff(ls(), c("dados", "clubes", "paises", "datas", "len_datas", "melhores_clubes", "maiores_streaks")))
save.image("pre_shiny.RData")
library(dplyr)
source("aux_shiny.R")
dados = read.csv("data/ranktodos.csv", stringsAsFactors = FALSE) %>%
select(-X) %>%
rename(Clube = nome,
Pais = pais,
Elo = rate,
Data = date) %>%
mutate(Data = as.Date(Data, format = "%Y.%m.%d"))
dados$Clube[which(dados$id == 618)] = "River Plate (Par)"
dados$Clube[which(dados$id == 826)] = "River Plate (Uru)"
dados$Clube[which(dados$id == 414)] = "Fortaleza (Col)"
dados$Clube[which(dados$id == 611)] = "Guarani (Par)"
dados$Clube[which(dados$id == 113)] = "Independiente (Bol)"
dados$Clube[which(dados$id == 928)] = "Portuguesa (Ven)"
dados$Clube[which(dados$id == 620)] = "San Lorenzo (Par)"
dados$Clube[which(dados$id == 124)] = "Santa Cruz (Bol)"
dados$Clube[which(dados$id == 732)] = "Sport Boys (Per)"
dados$Clube[which(dados$id == 525)] = "U. Catolica (Equ)"
dados$Clube[which(dados$Pais == "Bolivia")] = "Bolívia"
dados$Clube[which(dados$Pais == "Colombia")] = "Colômbia"
flags_df = tibble(Pais = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador",
"Paraguai", "Peru", "Uruguai", "Venezuela"),
flag = c('<img src="https://flagpedia.net/data/flags/mini/ar.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/bo.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/br.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/cl.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/co.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/ec.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/py.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/pe.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/uy.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/ve.png" width="29" height="20" /></a>'))
clubes = dados %>%
filter(Data == max(dados$Data)) %>%
arrange(desc(Elo)) %>%
.$Clube
paises = sort(unique(dados$Pais))
datas = sort(unique(dados$Data))
len_datas = length(datas)
# Times com maiores elos na história
melhores_clubes = dados %>%
mutate(Ano = format(Data, "%Y")) %>%
group_by(Clube, Pais, Ano) %>%
summarise(Elo = max(Elo)) %>%
ungroup() %>%
arrange(desc(Elo)) %>%
head(50) %>%
inner_join(flags_df) %>%
mutate(Clube = paste(flag, Clube)) %>%
select(-Pais, -flag)
# Time com mais tempo na primeira posição do ranking
maior_por_mes = dados %>%
group_by(Data) %>%
slice(which.max(Elo)) %>%
ungroup() %>%
mutate(Data = as.character(Data))
clube = maior_por_mes$Clube[1]
pais = maior_por_mes$Pais[1]
de = maior_por_mes$Data[1]
ate = NULL
meses = NULL
j = 1
m = 1
for(i in 2:nrow(maior_por_mes)) {
if(!(clube[j] == maior_por_mes$Clube[i] & pais[j] == maior_por_mes$Pais[i])) {
meses[j] = m
ate[j] = maior_por_mes$Data[i-1]
j = j + 1
m = 1
clube[j] = maior_por_mes$Clube[i]
pais[j] = maior_por_mes$Pais[i]
de[j] = maior_por_mes$Data[i]
} else {
m = m + 1
}
}
ate = c(ate, NA)
meses = c(meses, m)
maiores_streaks = tibble(Clube = clube, Pais = pais, De = de, Ate = ate, Meses = meses) %>%
mutate(De = format(as.Date(De), "%b %Y"),
Ate = format(as.Date(Ate), "%b %Y")) %>%
arrange(desc(Meses)) %>%
inner_join(flags_df) %>%
mutate(Clube = paste(flag, Clube),
Meses = as.integer(Meses)) %>%
select(-Pais, -flag)
rm(list = setdiff(ls(), c("dados", "clubes", "paises", "datas", "len_datas", "melhores_clubes", "maiores_streaks")))
save.image("pre_shiny.RData")
shiny::runApp()
clubes
load("~/GitHub/FDS-Final-Project/pre_shiny.RData")
clubes[1]
runApp()
library(dplyr)
source("aux_shiny.R")
dados = read.csv("data/ranktodos.csv", stringsAsFactors = FALSE) %>%
select(-X) %>%
rename(Clube = nome,
Pais = pais,
Elo = rate,
Data = date) %>%
mutate(Data = as.Date(Data, format = "%Y.%m.%d"))
dados$Clube[which(dados$id == 618)] = "River Plate (Par)"
dados$Clube[which(dados$id == 826)] = "River Plate (Uru)"
dados$Clube[which(dados$id == 414)] = "Fortaleza (Col)"
dados$Clube[which(dados$id == 611)] = "Guarani (Par)"
dados$Clube[which(dados$id == 113)] = "Independiente (Bol)"
dados$Clube[which(dados$id == 928)] = "Portuguesa (Ven)"
dados$Clube[which(dados$id == 620)] = "San Lorenzo (Par)"
dados$Clube[which(dados$id == 124)] = "Santa Cruz (Bol)"
dados$Clube[which(dados$id == 732)] = "Sport Boys (Per)"
dados$Clube[which(dados$id == 525)] = "U. Catolica (Equ)"
dados$Clube[which(dados$Pais == "Bolivia")] = "Bolívia"
dados$Clube[which(dados$Pais == "Colombia")] = "Colômbia"
flags_df = tibble(Pais = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador",
"Paraguai", "Peru", "Uruguai", "Venezuela"),
flag = c('<img src="https://flagpedia.net/data/flags/mini/ar.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/bo.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/br.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/cl.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/co.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/ec.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/py.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/pe.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/uy.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/ve.png" width="29" height="20" /></a>'))
clubes = dados %>%
filter(Data == max(dados$Data)) %>%
arrange(desc(Elo)) %>%
.$Clube
paises = sort(unique(dados$Pais))
datas = sort(unique(dados$Data))
len_datas = length(datas)
# Times com maiores elos na história
melhores_clubes = dados %>%
mutate(Ano = format(Data, "%Y")) %>%
group_by(Clube, Pais, Ano) %>%
summarise(Elo = max(Elo)) %>%
ungroup() %>%
arrange(desc(Elo)) %>%
head(50)
View(melhores_clubes)
library(dplyr)
source("aux_shiny.R")
dados = read.csv("data/ranktodos.csv", stringsAsFactors = FALSE) %>%
select(-X) %>%
rename(Clube = nome,
Pais = pais,
Elo = rate,
Data = date) %>%
mutate(Data = as.Date(Data, format = "%Y.%m.%d"))
dados$Clube[which(dados$id == 618)] = "River Plate (Par)"
dados$Clube[which(dados$id == 826)] = "River Plate (Uru)"
dados$Clube[which(dados$id == 414)] = "Fortaleza (Col)"
dados$Clube[which(dados$id == 611)] = "Guarani (Par)"
dados$Clube[which(dados$id == 113)] = "Independiente (Bol)"
dados$Clube[which(dados$id == 928)] = "Portuguesa (Ven)"
dados$Clube[which(dados$id == 620)] = "San Lorenzo (Par)"
dados$Clube[which(dados$id == 124)] = "Santa Cruz (Bol)"
dados$Clube[which(dados$id == 732)] = "Sport Boys (Per)"
dados$Clube[which(dados$id == 525)] = "U. Catolica (Equ)"
dados$Pais[which(dados$Pais == "Bolivia")] = "Bolívia"
dados$Pais[which(dados$Pais == "Colombia")] = "Colômbia"
flags_df = tibble(Pais = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador",
"Paraguai", "Peru", "Uruguai", "Venezuela"),
flag = c('<img src="https://flagpedia.net/data/flags/mini/ar.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/bo.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/br.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/cl.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/co.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/ec.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/py.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/pe.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/uy.png" width="29" height="20" /></a>',
'<img src="https://flagpedia.net/data/flags/mini/ve.png" width="29" height="20" /></a>'))
clubes = dados %>%
filter(Data == max(dados$Data)) %>%
arrange(desc(Elo)) %>%
.$Clube
paises = sort(unique(dados$Pais))
datas = sort(unique(dados$Data))
len_datas = length(datas)
# Times com maiores elos na história
melhores_clubes = dados %>%
mutate(Ano = format(Data, "%Y")) %>%
group_by(Clube, Pais, Ano) %>%
summarise(Elo = max(Elo)) %>%
ungroup() %>%
arrange(desc(Elo)) %>%
head(50) %>%
inner_join(flags_df) %>%
mutate(Clube = paste(flag, Clube)) %>%
select(-Pais, -flag)
# Time com mais tempo na primeira posição do ranking
maior_por_mes = dados %>%
group_by(Data) %>%
slice(which.max(Elo)) %>%
ungroup() %>%
mutate(Data = as.character(Data))
clube = maior_por_mes$Clube[1]
pais = maior_por_mes$Pais[1]
de = maior_por_mes$Data[1]
ate = NULL
meses = NULL
j = 1
m = 1
for(i in 2:nrow(maior_por_mes)) {
if(!(clube[j] == maior_por_mes$Clube[i] & pais[j] == maior_por_mes$Pais[i])) {
meses[j] = m
ate[j] = maior_por_mes$Data[i-1]
j = j + 1
m = 1
clube[j] = maior_por_mes$Clube[i]
pais[j] = maior_por_mes$Pais[i]
de[j] = maior_por_mes$Data[i]
} else {
m = m + 1
}
}
ate = c(ate, NA)
meses = c(meses, m)
maiores_streaks = tibble(Clube = clube, Pais = pais, De = de, Ate = ate, Meses = meses) %>%
mutate(De = format(as.Date(De), "%b %Y"),
Ate = format(as.Date(Ate), "%b %Y")) %>%
arrange(desc(Meses)) %>%
inner_join(flags_df) %>%
mutate(Clube = paste(flag, Clube),
Meses = as.integer(Meses)) %>%
select(-Pais, -flag)
rm(list = setdiff(ls(), c("dados", "clubes", "paises", "datas", "len_datas", "melhores_clubes", "maiores_streaks")))
save.image("pre_shiny.RData")
runApp()
read.csv(paste0("data/", pais[1], ".csv"))
pais = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador", "Paraguai", "Peru", "Uruguai", "Venezuela")
read.csv(paste0("data/", pais[1], ".csv"))
read.csv(paste0("data/", pais[1], ".csv")) %>% View()
read.csv(paste0("data/", pais[1], ".csv"))
View(.Last.value)
csv2009 = read.csv(paste0("data/", pais[1], "_2009.csv"))
csv2019 = read.csv(paste0("data/", pais[1], "_2019.csv"))
View(csv2019)
csv_2019 = read.csv(paste0("data/", pais[1], "_2019.csv"))
csv_novo = rbind(csv, csv2019)
csv = read.csv(paste0("data/", pais[1], ".csv"))
csv_2019 = read.csv(paste0("data/", pais[1], "_2019.csv"))
csv_novo = rbind(csv, csv2019)
View(csv_novo)
csv_novo = rbind(csv, csv2019) %>%
distinct()
library(dplyr)
pais = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador", "Paraguai", "Peru", "Uruguai", "Venezuela")
csv = read.csv(paste0("data/", pais[1], ".csv"))
csv_2019 = read.csv(paste0("data/", pais[1], "_2019.csv"))
csv_novo = rbind(csv, csv2019) %>%
distinct()
View(csv)
anti_join(csv_novo, csv)
?write.table
write.table(csv_novo, "data/", pais[1], "_atualizado.csv")
write.table(csv_novo, paste0("data/", pais[1], "_atualizado.csv"))
write.table(csv_novo, paste0("data/", pais[1], "_atualizado.csv"), sep = ",", row.names = FALSE)
write.table(csv_novo, paste0("data/", pais[1], "_atualizado.csv"), sep = ",", row.names = FALSE)
write.table(csv_novo, paste0("data/", pais[1], "_atualizado.csv"), sep = ",", row.names = FALSE, na = "")
library(dplyr)
pais = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador", "Paraguai", "Peru", "Uruguai", "Venezuela")
for(i in pais) {
csv = read.csv(paste0("data/", pais[i], ".csv"))
csv_2019 = read.csv(paste0("data/", pais[i], "_2019.csv"))
csv_novo = rbind(csv, csv2019) %>%
distinct()
write.table(csv_novo, paste0("data/", pais[i], "_atualizado.csv"), sep = ",", row.names = FALSE, na = "")
}
i
library(dplyr)
pais = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador", "Paraguai", "Peru", "Uruguai", "Venezuela")
for(i in pais) {
csv = read.csv(paste0("data/", pais[i], ".csv"))
csv_2019 = read.csv(paste0("data/", pais[i], "_2019.csv"))
csv_novo = rbind(csv, csv2019) %>%
distinct()
write.table(csv_novo, paste0("data/", pais[i], "_atualizado.csv"), sep = ",", row.names = FALSE, na = "")
}
i
library(dplyr)
paises = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador", "Paraguai", "Peru", "Uruguai", "Venezuela")
for(pais in paises) {
csv = read.csv(paste0("data/", pais, ".csv"))
csv_2019 = read.csv(paste0("data/", pais, "_2019.csv"))
csv_novo = rbind(csv, csv2019) %>%
distinct()
write.table(csv_novo, paste0("data/", pais, "_atualizado.csv"), sep = ",", row.names = FALSE, na = "")
}
library(dplyr)
paises = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador", "Paraguai", "Peru", "Uruguai", "Venezuela")
for(pais in paises) {
csv = read.csv(paste0("data/", pais, ".csv"))
csv_2019 = read.csv(paste0("data/", pais, "_2019.csv"))
csv_novo = rbind(csv, csv_2019) %>%
distinct()
write.table(csv_novo, paste0("data/", pais, "_atualizado.csv"), sep = ",", row.names = FALSE, na = "")
}
read.csv("data/Argentina_atualizado.csv")
a = read.csv("data/Argentina_atualizado.csv")
View(a)
a %>% count()
a %>% count(date, club_1, club_2) %>% arrange(desc(n)) %>% View()
library(dplyr)
paises = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador", "Paraguai", "Peru", "Uruguai", "Venezuela", "Continentais")
for(pais in paises) {
csv = read.csv(paste0("data/", pais, ".csv"))
csv_2019 = read.csv(paste0("data/", pais, "_2019.csv"))
csv_novo = rbind(csv, csv_2019) %>%
distinct()
write.table(csv_novo, paste0("data/", pais, "_atualizado.csv"), sep = ",", row.names = FALSE, na = "")
}
pais = "Argentina"
csv = read.csv(paste0("data/old/", pais, ".csv"))
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"))
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
mutate(Data = arruma_data(Data))
arruma_data <- function(x) {
if(nchar(x) == 15) {
ano1 = str_sub(x, start = 7, end = 10)
ano2 = str_sub(x, start = 12, end = 15)
if(as.integer(str_sub(x, start = 4, end = 5)) >= 7) {
x = (paste0(str_sub(x, start = 1, end = 6), ano1))
} else {
x = (paste0(str_sub(x, start = 1, end = 6), ano2))
}
}
as.Date(x, "%d.%m.%Y")
}
csv = read.csv(paste0("data/old/", pais, ".csv"))
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"))
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
mutate(Data = arruma_data(Data))
csv = read.csv(paste0("data/old/", pais, ".csv"))
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"))
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
mutate(Date = arruma_data(Date))
csv = read.csv(paste0("data/old/", pais, ".csv"))
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"))
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
mutate(date = arruma_data(date))
csv = read.csv(paste0("data/old/", pais, ".csv"), stringsAsFactors = FALSE)
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"), stringsAsFactors = FALSE)
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
mutate(date = arruma_data(date))
library(stringr)
csv = read.csv(paste0("data/old/", pais, ".csv"), stringsAsFactors = FALSE)
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"), stringsAsFactors = FALSE)
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
mutate(date = arruma_data(date))
csv = read.csv(paste0("data/old/", pais, ".csv"), stringsAsFactors = FALSE)
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"), stringsAsFactors = FALSE)
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
rowwise() %>%
mutate(date = arruma_data(date))
csv = read.csv(paste0("data/old/", pais, ".csv"), stringsAsFactors = FALSE)
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"), stringsAsFactors = FALSE)
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
rowwise() %>%
mutate(Data = arruma_data(date))
csv = read.csv(paste0("data/old/", pais, ".csv"), stringsAsFactors = FALSE)
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"), stringsAsFactors = FALSE)
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
rowwise() %>%
mutate(Data = arruma_data(date)) %>%
filter(Data <= "2019-09-03")
csv = read.csv(paste0("data/old/", pais, ".csv"), stringsAsFactors = FALSE)
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"), stringsAsFactors = FALSE)
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
rowwise() %>%
mutate(Data = arruma_data(date)) %>%
filter(Data <= "2019-09-03")
library(dplyr)
library(stringr)
arruma_data <- function(x) {
if(nchar(x) == 15) {
ano1 = str_sub(x, start = 7, end = 10)
ano2 = str_sub(x, start = 12, end = 15)
if(as.integer(str_sub(x, start = 4, end = 5)) >= 7) {
x = (paste0(str_sub(x, start = 1, end = 6), ano1))
} else {
x = (paste0(str_sub(x, start = 1, end = 6), ano2))
}
}
as.Date(x, "%d.%m.%Y")
}
paises = c("Argentina", "Bolívia", "Brasil", "Chile", "Colômbia", "Equador", "Paraguai", "Peru", "Uruguai", "Venezuela", "Continentais")
for(pais in paises) {
csv = read.csv(paste0("data/old/", pais, ".csv"), stringsAsFactors = FALSE)
csv_2019 = read.csv(paste0("data/old/", pais, "_2019.csv"), stringsAsFactors = FALSE)
csv_novo = rbind(csv, csv_2019) %>%
distinct() %>%
rowwise() %>%
mutate(Data = arruma_data(date)) %>%
filter(Data <= "2019-09-03") %>%
select(-Data)
write.table(csv_novo, paste0("data/", pais, "_atualizado.csv"), sep = ",", row.names = FALSE, na = "")
}
#8369
